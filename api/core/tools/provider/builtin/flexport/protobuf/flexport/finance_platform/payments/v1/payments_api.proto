// TEAM: finance_platform

syntax = "proto3";

package flexport.finance_platform.payments.v1;

import "flexport/payments/bill/v1beta1/bill.proto";
import "flexport/payments/invoice/v1beta1/invoice.proto";
import "flexport/payments/netsuitecompanyentity/v1beta1/netsuite_company_entity.proto";
import "google/protobuf/wrappers.proto";

option java_multiple_files = true;
option java_outer_classname = "PaymentsApiProto";
option java_package = "com.flexport.financeplatform.payments.v1";
option ruby_package = "Flexport::FinancePlatform::Payments::V1";

// The protocol for all payments api.
service PaymentsAPI {
  // Get netsuite company entity.
  rpc GetNetsuiteCompanyEntity(GetNetsuiteCompanyEntityRequest) returns (GetNetsuiteCompanyEntityResponse);
  // Get count of bills.
  rpc GetBillCount(GetBillCountRequest) returns (GetBillCountResponse);
  // Get bills.
  rpc GetBills(GetBillsRequest) returns (GetBillsResponse);
  // Get a company entity fid.
  rpc GetCompanyEntityFidByBankAccountNumber(GetCompanyEntityFidByBankAccountNumberRequest) returns (GetCompanyEntityFidByBankAccountNumberResponse);
  // Get a list of invoices.
  rpc GetInvoices(GetInvoicesRequest) returns (GetInvoicesResponse);
  // Close a Deliverr Invoice with its corresponding Intercompany JE.
  rpc CloseDeliverrInvoices(CloseDeliverrInvoicesRequest) returns (CloseDeliverrInvoicesResponse);
}

message GetNetsuiteCompanyEntityRequest {
  string company_entity_fid = 1;
}

message GetNetsuiteCompanyEntityResponse {
  flexport.payments.netsuitecompanyentity.v1beta1.NetsuiteCompanyEntity entity = 1;
}

message GetBillCountRequest {
  flexport.payments.bill.v1beta1.BillFilters filters = 1;
}

message GetBillCountResponse {
  int32 count = 1;
}

message GetBillsRequest {
  flexport.payments.bill.v1beta1.BillFilters filters = 1;
}

message GetBillsResponse {
  repeated flexport.payments.bill.v1beta1.Bill results = 1;
}

message GetCompanyEntityFidByBankAccountNumberRequest {
  string vendor_fid = 1;
  string currency_code = 2;
  repeated string bank_account_numbers = 3;
}

message GetCompanyEntityFidByBankAccountNumberResponse {
  google.protobuf.StringValue company_entity_fid = 1;
}

message GetInvoicesRequest {
  flexport.payments.invoice.v1beta1.InvoiceFilterDto filters = 1;
}

message GetInvoicesResponse {
  repeated flexport.payments.invoice.v1beta1.Invoice invoices = 1;
}

message CloseDeliverrInvoicesRequest {
  repeated google.protobuf.StringValue invoice_names = 1;
}

message CloseDeliverrInvoiceResult {
  google.protobuf.StringValue invoice_name = 1;
  google.protobuf.BoolValue success = 2;
  optional google.protobuf.StringValue error_message = 3;
}

message CloseDeliverrInvoicesResponse {
  repeated CloseDeliverrInvoiceResult results = 1;
}
