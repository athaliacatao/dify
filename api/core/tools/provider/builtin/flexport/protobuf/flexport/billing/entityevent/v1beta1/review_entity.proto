// TEAM: billing

syntax = "proto3";

package flexport.billing.entityevent.v1beta1;

import "flexport/billing/entityevent/v1beta1/draft_bill_entity.proto";
import "flexport/billing/entityevent/v1beta1/reviewed_bill_entity.proto";
import "google/protobuf/timestamp.proto";
import "google/protobuf/wrappers.proto";

option java_multiple_files = true;
option java_outer_classname = "ReviewEntityProto";
option java_package = "com.flexport.billing.entityevent.v1beta1";
option ruby_package = "Flexport::Billing::EntityEvent::V1Beta1";

// The Review entity object.
message ReviewEntity {
  string fid = 1;
  string bill_grouping_fid = 2;
  google.protobuf.Timestamp due_at_time = 3 [deprecated = true];
  google.protobuf.Timestamp completed_at_time = 4;
  google.protobuf.Timestamp bill_created_at_time = 5;
  google.protobuf.Timestamp approved_at_time = 6;
  google.protobuf.Timestamp rejected_at_time = 7;
  google.protobuf.Timestamp bill_creation_failed_at_time = 8;
  google.protobuf.Timestamp cancelled_at_time = 9;
  google.protobuf.Timestamp created_at_time = 10;
  google.protobuf.Timestamp updated_at_time = 11;
  repeated ValidationErrorValue validation_errors = 12;
  DraftBillEntity draft_bill = 13;
  ReviewedBillEntity reviewed_bill = 14;
  google.protobuf.BoolValue is_touchless_bill_enabled = 15;
  google.protobuf.Timestamp to_be_reviewed_by_time = 16;
  google.protobuf.StringValue outdated_by_fid = 17;
  google.protobuf.StringValue created_bill_fid = 18;
  google.protobuf.StringValue manual_review_fid = 19;
  google.protobuf.Timestamp manual_review_creation_failed_at_time = 20;
  google.protobuf.BoolValue bill_modified = 21;
}

// The ValidationError value object.
message ValidationErrorValue {
  ValidationErrorType type = 1;
  ValidationElementType element_type = 2;
  google.protobuf.StringValue element_fid = 3;
  ValidationErrorMetadataValue metadata = 4;
  string rendered_message = 5;
}

// The ValidationError type enum.
enum ValidationErrorType {
  reserved 20, 21;

  VALIDATION_ERROR_TYPE_INVALID = 0;
  VALIDATION_ERROR_TYPE_UNKNOWN = 1;
  VALIDATION_ERROR_TYPE_GENERIC_ERROR = 2;
  VALIDATION_ERROR_TYPE_DUPLICATE_BILL_NAME = 3;
  VALIDATION_ERROR_TYPE_MISSING_BILL_NUMBER = 4;
  VALIDATION_ERROR_TYPE_MISSING_BILL_ISSUING_ENTITY_FID = 5;
  VALIDATION_ERROR_TYPE_MISSING_BILL_ISSUING_ENTITY = 6;
  VALIDATION_ERROR_TYPE_MISSING_BILL_RECEIVING_ENTITY_FID = 7;
  VALIDATION_ERROR_TYPE_MISSING_BILL_RECEIVING_ENTITY = 8;
  VALIDATION_ERROR_TYPE_SIMILAR_BILL_NUMBER = 9;
  VALIDATION_ERROR_TYPE_INVALID_PAST_BILL_DUE_DATE = 10 [deprecated = true];
  VALIDATION_ERROR_TYPE_MISSING_BILL_DUE_DATE = 11;
  VALIDATION_ERROR_TYPE_MISSING_NETSUITE_COMPANY_ENTITY = 12;
  VALIDATION_ERROR_TYPE_MISMATCHED_BILL_ISSUING_ENTITY = 13;
  VALIDATION_ERROR_TYPE_MISMATCHED_BILL_RECEIVING_ENTITY = 14;
  VALIDATION_ERROR_TYPE_MISSING_ISSUING_ENTITY_BILLABLE_DEFAULT_ENTITY = 15;
  VALIDATION_ERROR_TYPE_SIMILAR_BILL_TOTAL_AMOUNT = 16;
  VALIDATION_ERROR_TYPE_LARGE_BILL_TOTAL_AMOUNT = 17;
  VALIDATION_ERROR_TYPE_SMALL_BILL_TOTAL_AMOUNT = 18;
  VALIDATION_ERROR_TYPE_ALLOCATION_SHIPMENT_MISSING = 19;
  VALIDATION_ERROR_TYPE_MISSING_BILL_ITEM_AMOUNT = 22;
  VALIDATION_ERROR_TYPE_MISSING_BILL_ITEM_CURRENCY = 23;
  VALIDATION_ERROR_TYPE_NEGATIVE_BILL_ITEM_AMOUNT = 24 [deprecated = true];
  VALIDATION_ERROR_TYPE_CORE_UNSUPPORTED_BILL_ITEM_CURRENCY = 25;
  VALIDATION_ERROR_TYPE_NETSUITE_UNSUPPORTED_BILL_ITEM_CURRENCY = 26;
  VALIDATION_ERROR_TYPE_EMPTY_CONSOL_SHIPMENT_ALLOCATION = 27;
  VALIDATION_ERROR_TYPE_DUPLICATE_BILL = 28;
  VALIDATION_ERROR_TYPE_BILL_NAME_MAX_LENGTH_EXCEEDED = 29;
  VALIDATION_ERROR_TYPE_PAYMENTS_DISABLED_FOR_ISSUING_ENTITY = 30;
  VALIDATION_ERROR_TYPE_DUPLICATE_SHIPMENT_ALLOCATIONS = 31;
  VALIDATION_ERROR_TYPE_INCONSISTENT_CREDIT_NOTE_TOTAL_AMOUNT = 32;
  VALIDATION_ERROR_TYPE_INCONSISTENT_NON_CREDIT_NOTE_TOTAL_AMOUNT = 33;
  VALIDATION_ERROR_TYPE_LINE_ITEM_MAPPING_MISSING = 34;
  VALIDATION_ERROR_TYPE_DUPLICATE_LINE_ITEM_MAPPING = 35;
  VALIDATION_ERROR_TYPE_MISSING_REFERENCE = 36;
  VALIDATION_ERROR_TYPE_CARRIER_BILL_WITH_BOOKING_MANAGEMENT = 37;
  VALIDATION_ERROR_TYPE_MISSING_BILL_ITEMS = 38;
}

// The ValidationElement type enum.
enum ValidationElementType {
  VALIDATION_ELEMENT_TYPE_INVALID = 0;
  VALIDATION_ELEMENT_TYPE_NONE = 1;
  VALIDATION_ELEMENT_TYPE_ITEM = 2;
  VALIDATION_ELEMENT_TYPE_ALLOCATION = 3;
}

// The ValidationErrorMetadata value object.
message ValidationErrorMetadataValue {
  oneof value {
    StringValueMetadataValue string_value_metadata = 1;
    InstantValueMetadataValue instant_value_metadata = 2;
    FlexportResourceIdentifierValueMetadataValue flexport_resource_identifier_value_metadata = 3;
    AmountThresholdMetadataValue amount_threshold_metadata = 4;
    DuplicateBillNameErrorMetadataValue duplicate_bill_name_error_metadata = 5;
    MismatchedBillIssuingEntityErrorMetadataValue mismatched_bill_issuing_entity_error_metadata = 6;
    MismatchedBillReceivingEntityErrorMetadataValue mismatched_bill_receiving_entity_error_metadata = 7;
    BillNameLengthErrorMetadataValue bill_name_length_error_metadata = 8;
    DuplicateBillErrorMetadataValue duplicate_bill_error_metadata = 9;
  }
}

// The AmountThresholdMetadata value object.
message AmountThresholdMetadataValue {
  string amount = 1;
  string threshold = 2;
}

// The BillNameLengthErrorMetadata value object.
message BillNameLengthErrorMetadataValue {
  string value = 1;
  string threshold = 2;
}

// The DuplicateBillErrorMetadata value object.
message DuplicateBillErrorMetadataValue {
  int32 duplicate_bill_count = 1;
  string duplicate_bill_name = 2;
  string vendor_fid = 3;
  string receiving_entity_fid = 4;
}

// The DuplicateBillNameErrorMetadata value object.
message DuplicateBillNameErrorMetadataValue {
  int32 duplicate_bill_count = 1;
  string duplicate_bill_name = 2;
  string vendor_fid = 3;
}

// The FlexportResourceIdentifivierValueMetadata value object.
message FlexportResourceIdentifierValueMetadataValue {
  google.protobuf.StringValue value = 1;
}

// The InstantValueMetadata value object.
message InstantValueMetadataValue {
  google.protobuf.Timestamp value_time = 1;
}

// The MismatchedBillIssuingEntityErrorMetadata value object.
message MismatchedBillIssuingEntityErrorMetadataValue {
  string issuing_entity_fid = 1;
  google.protobuf.StringValue issuing_company_fid = 2;
  string vendor_fid = 3;
}

// The MismatchedBillReceivingEntityErrorMetadata value object.
message MismatchedBillReceivingEntityErrorMetadataValue {
  string issuing_entity_fid = 1;
  string billable_entity_default_fid = 2;
  string receiving_entity_fid = 3;
}

// The StringValueMetadata value object.
message StringValueMetadataValue {
  google.protobuf.StringValue value = 1;
}
