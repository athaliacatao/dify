// TEAM: starship

syntax = "proto3";

package flexport.workflow.prelude.options.v1;

import "google/protobuf/descriptor.proto";

option java_multiple_files = true;
option java_outer_classname = "OptionsProto";
option java_package = "com.flexport.workflow.prelude.options.v1";
option ruby_package = "Flexport::Workflow::Prelude::Options::V1";

// The config for WpEvent.
message WpEventConfig {
  // the readable name.
  string name = 1;
  // the description.
  string description = 2;
  // the resource key of event.
  string resource_key = 3;
}

// The config for WpAction.
message WpActionConfig {
  // the readable name.
  string name = 1;
  // the description.
  string description = 2;
  // the resource key of action.
  string resource_key = 3;
  // the action icon shown in the frontend.
  string icon = 10;
  // the service name for gRPC Action.
  string service_name = 20;
}

// The config for EventLog on root events.
message EventLogConfig {
  // the topic name for action via eventlog.
  string topic = 1;
  // the template of partition key for action via eventlog, in SpEL.
  string partition_key = 2;
  // the backpack field, separated by dot if more than one index.
  string backpack_field = 3;
}

extend google.protobuf.MessageOptions {
  string wp_message_key = 10000;
  // define WpEvent.
  WpEventConfig wp_event = 10001;
  // define WpAction.
  WpActionConfig wp_action = 10002;
  // eventlog config.
  EventLogConfig event_log = 10003;
}

extend google.protobuf.MethodOptions {
  // define actions via gRPC.
  WpActionConfig grpc_wp_action = 10000;
}

extend google.protobuf.FieldOptions {
  // define backpacked actions from fields corresponding to `oneof`.
  WpActionConfig backpack_wp_action = 10000;
}
