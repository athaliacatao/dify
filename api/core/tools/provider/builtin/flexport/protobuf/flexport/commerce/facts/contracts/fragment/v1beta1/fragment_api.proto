// TEAM: client_order

syntax = "proto3";

package flexport.commerce.facts.contracts.fragment.v1beta1;

import "flexport/commerce/facts/contracts/common/v1beta1/common.proto";
import "flexport/commerce/facts/contracts/options/v1/options.proto";
import "google/protobuf/any.proto";

option java_multiple_files = true;
option java_outer_classname = "FragmentApiProto";
option java_package = "com.flexport.commerce.facts.contracts.fragment.v1beta1";
option ruby_package = "Flexport::Commerce::Facts::Contracts::Fragment::V1Beta1";

service FragmentAPI {
  rpc SubmitFragment(SubmitFragmentRequest) returns (SubmitFragmentResponse);
}

message SubmitFragmentRequest {
  CommerceFactsFragment fragment = 1;
}

message SubmitFragmentResponse {
  bool has_validator_errors = 1;

  message ValidatorWithErrors {
    flexport.commerce.facts.contracts.options.v1.Validator validator = 1;
    string service = 2;
    repeated flexport.commerce.facts.contracts.common.v1beta1.ValidateError errors = 3;
  }
  repeated ValidatorWithErrors validator_with_errors = 2;

  message SubscriberWithError {
    flexport.commerce.facts.contracts.options.v1.Subscriber subscriber = 1;
    string error = 2;
  }
  repeated SubscriberWithError subscriber_with_error = 3;
}

message CommerceFactsFragment {
  string resource_fid = 1;
  google.protobuf.Any fragment_facts = 3;

  optional string actor_fid = 4;
  string source = 5;
  string reason = 6;
}
