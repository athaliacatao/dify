// TEAM: lumina

syntax = "proto3";

package flexport.monolith.warehouse.v1beta1;

import "google/protobuf/timestamp.proto";

option java_multiple_files = true;
option java_outer_classname = "ShipmentDocumentApiProto";
option java_package = "com.flexport.monolith.warehouse.v1beta1";
option ruby_package = "Flexport::Monolith::Warehouse::V1Beta1";

message Document {
  string document_id = 1;
  string name = 2;
  string flex_id = 3;
  string document_type = 4;
  string uploaded_by = 5;
  google.protobuf.Timestamp uploaded_at = 6;
  string memo = 7;
}

service ShipmentDocumentAPI {
  rpc SearchDocuments(SearchDocumentsRequest) returns (SearchDocumentsResponse);
  rpc DownloadDocument(DownloadDocumentRequest) returns (DownloadDocumentResponse);
  rpc PreSignedUploadUrl(PreSignedUploadUrlRequest) returns (PreSignedUploadUrlResponse);
  rpc UploadDocuments(UploadDocumentsRequest) returns (UploadDocumentsResponse);
}

message SearchDocumentsRequest {
  string flex_id = 1;
  repeated string document_types = 2;
}

message SearchDocumentsResponse {
  repeated Document documents = 1;
  repeated string errors = 2;
}

message DownloadDocumentRequest {
  string document_id = 1;
}

message DownloadDocumentResponse {
  string download_url = 1;
  repeated string errors = 2;
}

message PreSignedUploadUrlRequest {
  string filename = 1;
}

message PreSignedUploadUrlResponse {
  string upload_url = 1;
  repeated string errors = 2;
}

message UploadDocumentsRequest {
  repeated UploadDocumentInput documents = 1;
  string flex_id = 2;
  string uploaded_by = 3;
}

message UploadDocumentsResponse {
  repeated string errors = 1;
}

message UploadDocumentInput {
  string filename = 1;
  string document_type = 2;
  string memo = 3;
}
