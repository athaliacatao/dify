// TEAM: unified_shipment_schedules

syntax = "proto3";

package flexport.schedulemanager.datechanges.v1;

import "flexport/executioncoordinator/types/enums/v1/entry_point.proto";
import "flexport/schedulemanager/datechanges/v1/leg_date_change.proto";

option java_multiple_files = true;
option java_outer_classname = "ScheduleDatesChangeProto";
option java_package = "com.flexport.schedulemanager.datechanges.v1";
option ruby_package = "Flexport::ScheduleManager::DateChanges::V1";

// A collection of proposed leg date changes that should attempt to be applied to a specific shipment schedule.
message ScheduleDatesChange {
  // REQUIRED. Identifier for the target schedule to apply date changes to.
  oneof identifier {
    string shipment_fid = 1;
    string execution_order_fid = 2;
  }
  // REQUIRED. Proposed date changes. Must be at least one. If attempting to clear all dates a LegDateChange must be
  // created that corresponds to each existing date to clear.
  repeated flexport.schedulemanager.datechanges.v1.LegDateChange leg_date_changes = 3;
  // REQUIRED. Details about the source of proposed date changes.
  ScheduleDatesChangeMetadata metadata = 4;
}

// Metadata capturing the source details about ScheduleDatesChange proposed date changes.
message ScheduleDatesChangeMetadata {
  // REQUIRED. User (can be a bot) that is proposing the set of date changes.
  string user_fid = 1;
  // REQUIRED. Unique identifier (should not match entry_point used by ANY OTHER sources creating ScheduleDatesChanges)
  // for the source of proposed date changes.
  flexport.executioncoordinator.types.enums.v1.EntryPoint entry_point = 2;
  // OPTIONAL. Triggering source for entry_point. ONLY SET THIS FIELD IF YOU KNOW HOW IT"S USED!
  flexport.executioncoordinator.types.enums.v1.EntryPoint triggering_entry_point = 6;
  // REQUIRED. Name of engineering team proposing date changes.
  string team_name = 3;
  // REQUIRED. Exact Flexport repo path where ScheduleDatesChange is created.
  //   Note: call_site_path & team_name are not meant to be robust fields. They will primarily be used to aide in
  //     investigations and tracking owners of problematic date changes. In a perfect world entry_point would be good
  //     enough, but it does not suffice for the dozens of date change call sites. If everyone uses a unique entry_point
  //     then call_site_path & team_name can be deprecated in the future!
  string call_site_path = 4;
  // OPTIONAL. Identifier used by Visibility team.
  string visibility_trace_id = 5;
}
