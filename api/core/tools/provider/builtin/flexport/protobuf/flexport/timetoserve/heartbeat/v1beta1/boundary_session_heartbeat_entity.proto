// TEAM: application_framework

syntax = "proto3";

package flexport.timetoserve.heartbeat.v1beta1;

option java_multiple_files = true;
option java_outer_classname = "BoundarySessionHeartbeatEntityProto";
option java_package = "com.flexport.timetoserve.heartbeat.v1beta1";
option ruby_package = "Flexport::TimeToServe::Heartbeat::V1Beta1";

import "google/protobuf/timestamp.proto";

// Indicates a BoundarySession heartbeat that is logged to SOA ingestion from the time to serve engine.
message BoundarySessionHeartbeatEntity {
  // Represents whether the boundary is top level for a particular resource: ex: ShipmentDetails is a top level boundary for the shipment resource.
  message TopLevelBoundaryResourceMetadata {
    string resource_fid = 1;
    double duration_ms = 2;
  }
  string user_fid = 1;
  double heartbeat_interval_ms = 2;
  double document_visible_ms = 3;
  double mounted_duration_ms = 4;
  double hover_duration_ms = 5;
  bool in_iframe = 6;
  google.protobuf.Timestamp server_logged_utc_time = 7;
  string boundary_id = 8;
  string parent_boundary_id = 9;
  repeated string boundary_id_path = 10;
  string boundary_id_path_string = 11;
  string session_id = 12;
  string parent_session_id = 13;
  repeated string session_id_path = 14;
  string session_id_path_string = 15;
  repeated string resource_fids = 16;
  // Boundary session context
  string url_origin = 17;
  string url_path = 18;
  string url_query = 19;
  string url_fragment = 20;
  string full_story_link = 21;
  // Boundary session heartbeat event counts
  uint64 event_count_keyup = 22;
  uint64 event_count_keydown = 23;
  uint64 event_count_keypress = 24;
  uint64 event_count_backspace_keydown = 25;
  uint64 event_count_arrow_keydown = 26;
  uint64 event_count_click = 27;
  uint64 event_count_mouseenter = 28;
  uint64 event_count_mouseleave = 29;
  uint64 event_count_mousemove = 30;
  uint64 event_count_select = 31;
  uint64 event_count_wheel = 32;
  uint64 event_count_cut = 33;
  uint64 event_count_copy = 34;
  uint64 event_count_paste = 35;
  string heartbeat_id = 36;
  repeated TopLevelBoundaryResourceMetadata boundary_is_top_level_for_resource_fids = 37;
}
