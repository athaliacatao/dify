// TEAM: visibility

syntax = "proto3";

package flexport.executioncoordinator.types.visibility.v1;

import "flexport/executioncoordinator/types/enums/v1/entry_point.proto";
import "google/protobuf/timestamp.proto";

option java_multiple_files = true;
option java_outer_classname = "MetadataProto";
option java_package = "com.flexport.executioncoordinator.types.visibility.v1";
option ruby_package = "Flexport::ExecutionCoordinator::Types::Visibility::V1";

// Store metadata from upstream of ETSE and EOSE. eg. VisSource.
message Metadata {
  repeated VisSource vis_sources = 1;
  repeated DateChangedData date_changed_data = 2;
  repeated ItineraryDateChangeMetadata itinerary_date_change_metadata = 3;
}

// Indicate the upstream source of visibility.
message VisSource {
  // the source of secondary_source, indirect source for visibility. eg. ONEY
  string primary_source = 1;
  // direct source that provides data to visibility. eg. PROSERVE
  string secondary_source = 2;
  // the type of source. eg. CARRIER_INTEGRATION
  string source_type = 3;
  // the display name of primary_source. eg. Atlantic Container Line
  string primary_source_name = 4;
  // id in vis_sources table under fpos_visibility
  string id = 5;
}

// DateChanged Metadata from Schedule Cascading.
// TEAM: unified_shipment_schedules
message DateChangedData {
  // prediction source used to generate the date.
  string prediction_source = 1;
  // heuristic name responsible for the date change.
  string heuristic_name = 2;
  // fid of the user who made the date change from UI.
  string triggering_user_fid = 3;
  // entry point of the date change.
  flexport.executioncoordinator.types.enums.v1.EntryPoint triggering_entry_point = 4;
  // fid of the triggering CTDC ETSE date change.
  string triggering_ctdc_fid = 5;
  // GraphForm write_owner captured during CTDC Extract.
  string write_owner = 6;
  // GraphForm write_path captured during CTDC Extract.
  string write_path = 7;
}

message ItineraryDateChangeMetadata {
  string revision = 1;
  string itinerary_upserter = 2;
  string itinerary_process = 3;
  string fctdc_fid = 4;
  string manage_schedule_fid = 5;
  string created_by_user_fid = 8;
  string triggering_user_fid = 9;
  flexport.executioncoordinator.types.enums.v1.EntryPoint entry_point = 10;
  flexport.executioncoordinator.types.enums.v1.EntryPoint triggering_entry_point = 11;
  string tracking_id = 12;
  string tracking_reference_type = 13;
  string cargo_transit_date_changed_fid = 14;
  google.protobuf.Timestamp created_at = 15;
}
