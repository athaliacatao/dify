// TEAM: cost_capture

syntax = "proto3";

package flexport.financialvisibility.netrevenue.v1;

import "flexport/financialvisibility/utils/v1beta1/utils.proto";
import "flexport/financialvisibility/netrevenue/v1/net_revenue.proto";

option java_multiple_files = true;
option java_outer_classname = "NetRevenueApiProto";
option java_package = "com.flexport.financialvisibility.netrevenue.v1";
option ruby_package = "Flexport::FinancialVisibility::NetRevenue::V1";

// FinancialVisibility NetRevenue API.
service NetRevenueAPI {
  // Calculate net revenue for one or many shipments.
  rpc MultiCalculate(MultiCalculateRequest) returns (MultiCalculateResponse);
}

// A single request to calculate net revenue.
message CalculateRequest {
  string shipment_fid = 1;
  repeated CostRecord costs = 2;
}

// Response to a net revenue calculation request.
message CalculateResponse {
  repeated NRLineItem nr_line_items = 1;
}

message MultiNetRevenueCalculation {
  repeated CalculateResponse responses = 1;
}

// Request to calculate net revenue for multiple shipments.
message MultiCalculateRequest {
  repeated CalculateRequest requests = 1;
}

// Response to a net revenue calculation request for multiple shipments.
message MultiCalculateResponse {
  oneof result {
    MultiNetRevenueCalculation success_result = 1;
    financialvisibility.v1beta1.ErrorResult failure_result = 2;
  }
}
