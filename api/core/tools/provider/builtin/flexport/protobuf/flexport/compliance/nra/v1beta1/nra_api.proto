// TEAM: kingsroad

syntax = "proto3";

package flexport.compliance.nra.v1beta1;

import "flexport/executioncoordinator/itinerary/v1beta1/itinerary.proto";

option java_multiple_files = true;
option java_outer_classname = "NraProto";
option java_package = "com.flexport.compliance.nra.v1beta1";
option ruby_package = "Flexport::Compliance::Nra::V1Beta1";

// API for Nra
service NraAPI {
  // Deprecated: Use ValidateConsolAttachment instead.
  rpc ValidateShipmentAttachment(ValidateShipmentAttachmentRequest) returns (ValidateShipmentAttachmentResponse) {
    option deprecated = true;
  };

  // Validate the attachment
  rpc ValidateConsolAttachment(ValidateConsolAttachmentRequest) returns (ValidateConsolAttachmentResponse);

  // Validate the itinerary update
  rpc ValidateItineraryUpdate(ValidateItineraryUpdateRequest) returns (ValidateItineraryUpdateResponse);

  // Create a diversion
  rpc CreateDiversion(CreateDiversionRequest) returns (CreateDiversionResponse);
}

message ValidateShipmentAttachmentRequest {
  string master_shipment_fid = 1;
  string child_shipment_fid = 2;
}

message ValidateShipmentAttachmentResponse {
  bool is_valid = 1;
  repeated string errors = 2;
}

message ValidateConsolAttachmentRequest {
  flexport.executioncoordinator.itinerary.v1beta1.Itinerary master_itinerary = 1;
  repeated flexport.executioncoordinator.itinerary.v1beta1.Itinerary child_itinerary = 2;
}

message ValidateConsolAttachmentResponse {
  bool is_valid = 1;
  repeated string errors = 2;
}

message ValidateItineraryUpdateRequest {
  flexport.executioncoordinator.itinerary.v1beta1.Itinerary old_itinerary = 1;
  flexport.executioncoordinator.itinerary.v1beta1.Itinerary new_itinerary = 2;
}

message ValidateItineraryUpdateResponse {
  bool is_valid = 1;
  repeated string errors = 2;
}

message CreateDiversionRequest {
  flexport.executioncoordinator.itinerary.v1beta1.Itinerary old_itinerary = 1;
  flexport.executioncoordinator.itinerary.v1beta1.Itinerary new_itinerary = 2;
}

message CreateDiversionResponse {
  repeated string errors = 1;
}
