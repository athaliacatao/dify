// TEAM: client_app
syntax = "proto3";

package flexport.clientfreightdata.milestoneupdate.v1beta1;

import "google/protobuf/timestamp.proto";

enum RequestType {
  REQUEST_TYPE_INVALID = 0;
  REQUEST_TYPE_INITIAL_MILESTONE = 1;
  REQUEST_TYPE_FOLLOW_UP_MILESTONE = 2;
  REQUEST_TYPE_FIX_MILESTONE_VALIDATION_FAILURE = 3;
}

// Payload of message queue, indicating which shipment & container need milestone updates.
message MilestoneUpdateRequest {
  string client_shipment_fid = 1;
  // Container numbers like "APZU3168506" used to consumed by FFA writer to generate context for operators,
  // indicating which containers need milestone updates.
  repeated string container_numbers = 2;
  // Indicates the time this request is initialized. It will be used to unique identify the request.
  // For now, {client_shipment_fid + request_time} can unique identify a request.
  google.protobuf.Timestamp request_time = 3;
  // Used to distinguish the type of request (initial or follow-up milestones)
  RequestType request_type = 4;
  // The mbl_number from client_subscription. MilestoneUpdateRequest must have either mbl_number or hbl_number.
  string mbl_number = 5;
  // The global_scac_code from client_subscription
  string global_scac_code = 6;
  // The flex_id from client_shipment
  string flex_id = 7;
  // The client_fid from client_subscription
  string client_fid = 8;
  // The core_shipment_fid from client_shipment
  string core_shipment_fid = 9;
  // Due at time for when milestones should be updated according to SLA
  google.protobuf.Timestamp milestones_update_request_due_at = 10;
  // The string referencing the milestone type to be corrected only for RequestType=3
  //  Deprecated  as of 9/28 to update to using multiple milestones, see item 13
  string milestone_type_to_fix = 11 [deprecated = true];
  // The client name
  string client_name = 12;
  // array of milestone_types_to_fix only for RequestType=3
  repeated string milestone_types_to_fix = 13;
  // String message communicating what flagged the item for manual tracking only for RequestType=3
  string display_message = 14;
  // The hbl_number from client_subscription. MilestoneUpdateRequest must have either mbl_number or hbl_number.
  string hbl_number = 15;
}
