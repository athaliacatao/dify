// TEAM: kingsroad

syntax = "proto3";

package flexport.executioncoordinator.executionorderstateevent.v1;

import "flexport/executioncoordinator/executionorderstateevent/v1/details/ocean_house_bill_of_lading_release_type_changed.proto";
import "flexport/executioncoordinator/types/enums/v1/house_bill_of_lading_transmission_mode.proto";
import "flexport/os/v1/types/cargo/v1/cargo.proto";
import "flexport/os/v1/types/walltimedate/v1/wall_time_date.proto";
import "google/protobuf/timestamp.proto";

option java_multiple_files = true;
option java_outer_classname = "OceanHouseBillOfLadingUpdatedProto";
option java_package = "com.flexport.executioncoordinator.executionorderstateevent.v1";
option ruby_package = "Flexport::ExecutionCoordinator::ExecutionOrderStateEvent::V1";

// An ocean house bill of lading has been updated.
// Currently, this event is published for ALL transportation modes,
// not just ocean, for legacy Compliance team purposes.
// However, for air shipments, please read
// HouseAirWaybillUpdated as the source of truth instead.
message OceanHouseBillOfLadingUpdated {
  // Deprecated in favor of "bill_of_lading_fid" - this maintains naming consistency across all events
  string house_bill_of_lading_fid = 1 [deprecated = true];
  // Deprecated in favor of "bill_of_lading_number" - this maintains naming consistency across all events
  string bill_number = 2 [deprecated = true];
  string flxt_bill_number_with_scac = 3;
  string bill_type = 4;
  OceanHouseBillOfLadingReleaseType release_method = 5;
  flexport.executioncoordinator.types.enums.v1.HouseBillOfLadingTransmissionMode transmission_mode = 6;
  string master_bill_number = 7;
  // The time when the bill of lading was (soft) deleted.
  // This is deprecated since as of May 2021, a new semantic event OceanHouseBillOfLadingDeleted event
  // has been created. Since there is a separate delete event, we would NEVER expect archive_time to
  // be set. Only the deletion event is generated upon HBL deletion, not the update one.
  google.protobuf.Timestamp archived_time = 8 [deprecated = true];
  // The time when the document attached to the bill of lading was archived.
  google.protobuf.Timestamp document_archived_time = 33;
  string document_fid = 9;
  string loi_for_telex_release_document_fid = 10;
  string release_document_fid = 11;
  string original_document_fid = 12;
  string shipper_fid = 13;
  string carrier_fid = 14;
  string exporter_address_fid = 15;
  string consignee_address_fid = 16;
  string formatted_consignee_address = 30;
  string formatted_exporter_address = 31;
  string formatted_notify_party_address = 32;
  string first_domestic_port_for_aci_fid = 17;
  string first_domestic_port_for_ams_fid = 18;
  string fmc_port_of_unloading_fid = 19;
  string port_of_loading_fid = 20;
  repeated string ports_of_call_fids = 21;
  string vessel_fid = 22;
  string voyage_tracking_number = 23;
  repeated string container_fids = 24;
  repeated HouseBillOfLadingContainerInfo container_infos = 34;
  string total_weight = 26;
  flexport.os.v1.types.cargo.v1.CargoWeightUnit weight_unit = 27;
  string total_volume = 28;
  flexport.os.v1.types.cargo.v1.CargoVolumeUnit volume_unit = 29;
  // The date at which cargo was loaded on board.
  flexport.os.v1.types.walltimedate.v1.WallTimeDate laden_date = 35;
  string last_foreign_port_for_ams_fid = 36;
  string last_foreign_port_for_aci_fid = 37;
  flexport.os.v1.types.walltimedate.v1.WallTimeDate estimated_date_of_unloading_for_ams_override = 38;
  string free_trade_zone_number = 39;
  string destination_agent = 40;
  string agent_reference_number = 41;
  string marks_and_numbers = 42;
  string pieces = 43;
  string description_of_goods = 44;
  string declared_value = 45;
  FreightPaymentTerm freight_payment_terms = 46;
  string special_instructions = 47;
  repeated HouseBillOfLadingAttachmentInfo attachments = 48;
  string reason_for_attachment = 49;
  string bill_of_lading_fid = 50;
  string bill_of_lading_number = 51;
  string place_of_receipt = 52;
  string pre_carriage_by = 53;
  google.protobuf.Timestamp original_document_printed = 54;
  google.protobuf.Timestamp draft_approved_at = 55;
  string original_document_printed_by = 56;
}

// Info related to a container and a house bill of lading.
// Corresponds to container_assignment.rb model in the monolith.
message HouseBillOfLadingContainerInfo {
  string container_fid = 1;
  flexport.os.v1.types.cargo.v1.CargoUnit unit_type = 2;
  int32 unit_quantity = 3;
  string weight = 4;
  flexport.os.v1.types.cargo.v1.CargoWeightUnit weight_unit = 5;
  string volume = 6;
  flexport.os.v1.types.cargo.v1.CargoVolumeUnit volume_unit = 7;
  string seal_number = 8;
  string cargo_description = 9;
}

// Info related house bill of lading attachments
// Corresponds to BillOfLading#documents.
//
// This is used when the shipper provides extra information (e.g. cargo details)
// which would not fit into the body of Cargo Description in HBL. It rarely happens, but all
// these attached documents will show as additional pages when the HBL is generated as a PDF.
message HouseBillOfLadingAttachmentInfo {
  string attachment_filename = 1;
  // As of May 25, 2021, document_type is always "Bill of Lading Attachment"
  string document_type = 2;
  string document_fid = 3;
  string document_memo = 4;
}

// Enum for freight payment term (app/constants/freight_payment_terms.rb).
enum FreightPaymentTerm {
  FREIGHT_PAYMENT_TERM_INVALID = 0;
  FREIGHT_PAYMENT_TERM_FREIGHT_COLLECT = 1;
  FREIGHT_PAYMENT_TERM_FREIGHT_PREPAID = 2;
}
