// TEAM: ocean_planning

syntax = "proto3";

package flexport.monolith.oceanfmtassignment.fmtassignment.v1beta1;

import "flexport/os/v1/types/walltimedate/v1/wall_time_date.proto";
import "google/protobuf/timestamp.proto";
import "google/protobuf/wrappers.proto";

option java_multiple_files = true;
option java_outer_classname = "FmtAssignmentProto";
option java_package = "com.flexport.monolith.oceanfmtassignment.fmtassignment.v1beta1";
option ruby_package = "Flexport::Monolith::OceanFmtAssignment::FmtAssignment::V1Beta1";

// Represents an assignment made by FMT.
message FmtAssignment {
  string fid = 1;
  google.protobuf.StringValue ocean_supply_inventory_fid = 2;
  google.protobuf.StringValue ocean_supply_inventory_bucket_fid = 35;
  google.protobuf.StringValue ocean_supply_carrier_profile_fid = 22;
  google.protobuf.StringValue legacy_allocation_id = 3;
  int32 teus = 4;
  int32 etd_week = 5;
  int32 etd_year = 6;
  // Time that the assignment was created.
  google.protobuf.Timestamp created_time = 7;
  // Time that the assignment was deleted (null if still active).
  google.protobuf.Timestamp deleted_time = 8;
  string carrier_name = 9;
  string contract_number = 10;
  string carrier_string = 11;
  string mother_vessel_name = 12;
  google.protobuf.Timestamp etd_proforma_time = 13;
  string origin_port_name = 14;
  google.protobuf.StringValue origin_via_port_name = 15;
  google.protobuf.StringValue destination_via_port_name = 16;
  string destination_port_name = 17;
  string shipment_fid = 18;
  string inventory_backed_offering_fid = 19;
  Route route = 20;
  google.protobuf.BoolValue ibo_inputs_modified = 21;
  string origin_locode = 23;
  string origin_via_locode = 24;
  string destination_via_locode = 25;
  string destination_locode = 26;
  string assignment_note = 32;
  int32 client_id = 34;
  google.protobuf.StringValue carrier_scac_code = 36;
  string contract_type = 37;
  repeated string premium_service_names = 38;
  google.protobuf.StringValue carrier_space_key = 39;
  string created_by_user_fid = 40;
  string override_reason = 41;
  repeated string assignment_flags = 42;
  int64 estimated_cost_micros = 43;
  string system_commit_type = 44;
}

// Vessel, schedules and modes of transfer for each leg of the journey.
message Route {
  repeated RouteSegment segments = 1;
}

// Individual leg of a route.
message RouteSegment {
  PortCall origin_port_call = 1;
  PortCall destination_port_call = 2;
  string carrier_string = 3;
  TransportationMode transportation_mode = 4;
  string vessel_imo_number = 5;
  string vessel_name = 6;
  string voyage_number = 7;
  VoyageType voyage_type = 8;
  string estimated_schedule_fid = 9;
  string connecting_leg_schedule_fid = 10;
}

// Details on one stop, which could be an ocean port or inland port.
message PortCall {
  // Full port name.
  string port_name = 1;
  flexport.os.v1.types.walltimedate.v1.WallTimeDate proforma_date = 2;
  flexport.os.v1.types.walltimedate.v1.WallTimeDate estimated_date = 3;
  // Port LOCODE, if known.
  string locode = 4;
}

// Vehicle type for a RouteSegment.
enum TransportationMode {
  TRANSPORTATION_MODE_INVALID = 0;
  TRANSPORTATION_MODE_OCEAN = 2;
  TRANSPORTATION_MODE_RAIL = 3;
  TRANSPORTATION_MODE_TRUCK = 4;
}

// Our best guess at the role of this segment in the route.
enum VoyageType {
  VOYAGE_TYPE_INVALID = 0;
  VOYAGE_TYPE_MOTHER_VESSEL = 1;
  VOYAGE_TYPE_FEEDER_VESSEL = 2;
  VOYAGE_TYPE_ORIGIN_TRANSSHIPMENT = 3;
  VOYAGE_TYPE_DESTINATION_TRANSSHIPMENT = 4;
}

// FMT assignment is created.
message FmtAssignmentCreated {
  string assignment_fid = 1;
  FmtAssignment assignment = 2;
  FmtAssignmentUpdateSource created_by = 4;
  // Time that the create event was published.
  google.protobuf.Timestamp created_time = 3 [deprecated = true];
}

// FMT assignment is deleted (assignments are immutable so there's no `update` operation.
message FmtAssignmentDeleted {
  string assignment_fid = 1;
  FmtAssignment assignment = 2;
  FmtAssignmentUpdateSource deleted_by = 4;
  // Time that the delete event was published.
  google.protobuf.Timestamp deleted_time = 3 [deprecated = true];
}

enum FmtAssignmentUpdateSource {
  FMT_ASSIGNMENT_UPDATE_SOURCE_INVALID = 0;
  FMT_ASSIGNMENT_UPDATE_SOURCE_CORE = 1;
  FMT_ASSIGNMENT_UPDATE_SOURCE_OCEAN_PLANNING = 2;
}
