// TEAM: client_app

syntax = "proto3";

package flexport.clientfreightdata.clientfreightshipment.v1beta1;

import "flexport/dumboindexing/clientshipmentexceptions/v1beta1/client_shipment_exceptions.proto";
import "flexport/dumboindexing/derivedshipment/v1beta1/derived_shipment.proto";
import "flexport/executioncoordinator/types/enums/v1/transportation_status.proto";
import "google/protobuf/timestamp.proto";
import "google/protobuf/wrappers.proto";

option java_multiple_files = true;
option java_outer_classname = "ClientFreightShipmentProto";
option java_package = "com.flexport.clientfreightdata.clientfreightshipment.v1beta1";
option ruby_package = "Flexport::ClientFreightData::ClientFreightShipment::V1Beta1";

// Proto Schema from Client Freight Shipment for indexing in Dumbo Indexing/SIS
// [NOTE] In Development! It's highly likely some fields will be deprecated.
message ClientFreightShipment {
  //
  // shipment_fid for Dumbo Indexing to index on
  string shipment_fid = 1;
  //
  //
  // The cargo ready date of a shipment.
  // https://flexport.slack.com/archives/C053NRDAUDN/p1687899142001939?thread_ts=1686874479.101369&cid=C053NRDAUDN
  // Since we don't have timezone, to avoid confusing the customer we're not including it.
  flexport.dumboindexing.derivedshipment.v1beta1.ShipmentIndexDate cargo_ready_date = 2 [deprecated = true];
  //
  // The transportation status of a shipment.
  flexport.executioncoordinator.types.enums.v1.TransportationStatus transportation_status = 3;
  //
  // The date of arrival to the port of loading.
  flexport.dumboindexing.derivedshipment.v1beta1.ShipmentIndexDate departure_port_arrival_date = 4;
  //
  // The date of departure from the port of loading.
  flexport.dumboindexing.derivedshipment.v1beta1.ShipmentIndexDate departure_port_departure_date = 5;
  //
  // The date of arrival to the port of unloading.
  flexport.dumboindexing.derivedshipment.v1beta1.ShipmentIndexDate arrival_port_arrival_date = 6;
  //
  // The address fid for the first origin node.
  string origin_address_fid = 7 [deprecated = true];
  //
  // The address fid for the port of loading.
  string departure_port_address_fid = 8;
  //
  // The address fid for the port of unloading.
  string arrival_port_address_fid = 9;
  //
  // The address fid for the final destination.
  string destination_address_fid = 10 [deprecated = true];
  //
  // The nominating client fid.
  string nominating_client_fid = 11;
  //
  // The max arrival date of the legs tagged as destination.
  // From a customer perspective, this would mean the shipment was delivered to the final destination, which is
  // different than "Gate Out" and "Empty Container Returned".
  // If a user filters by "Delivered in full date" then we should only show 3PL shipments b/c we don't know if 4PL
  // shipments have reached the final destination.
  flexport.dumboindexing.derivedshipment.v1beta1.ShipmentIndexDate delivered_in_full_date = 12 [deprecated = true];
  // An array containing all address fids from all location types.
  // Used to support the ANY filter option on locationFilters.
  repeated string all_address_fids = 13;
  //
  // An array containing all company entity fids from all entity types.
  // Used to support the company filter.
  // Decision not needed:
  // https://flexport.slack.com/archives/C05DBULQU7K/p1687897860465549
  repeated string company_entity_fids = 14;
  //
  // The creation time of the shipment.
  google.protobuf.Timestamp created_time = 15;
  //
  // Cursors used for sorting and pagination, we manually create a compound field of <date>_<shipment_fid>
  // to ensure uniqueness.
  // Deprecated, use created_time and create cursor in ClientFreightShipmentExtractor
  string time_of_creation_cursor = 16 [deprecated = true];
  // This cargo ready date is from the graph.earliest_cargo_ready_date.
  string cargo_ready_date_cursor = 17 [deprecated = true];
  //
  // All last free dates for all containers of a shipment. Represented as UTC timestamp at start of day.
  repeated string last_free_dates = 18;
  // Whether delivered_in_full_date field exists. Used for sorting.
  google.protobuf.BoolValue delivered_in_full_date_exists = 19 [deprecated = true];
  // Whether cargo_ready_date field exists. Used for sorting.
  google.protobuf.BoolValue cargo_ready_date_exists = 20 [deprecated = true];
  // Decision to split delivery date field into the arrival port arrival date field and final destination field
  // can be found in this slack thread: https://flexport.slack.com/archives/C01TKSHR1EW/p1659123194838089
  // This arrival port delivery date comes from the EC derived shipment arrivalPortArrivalDate
  // Deprecated, create cursor from arrival_port_arrival_date
  string arrival_port_arrival_date_cursor = 21 [deprecated = true];
  // This final destination delivery date comes from the EC derived shipment deliveredInFullDate
  string delivered_in_full_date_cursor = 22 [deprecated = true];
  // Whether arrival_port_arrival_date field exists. Used for sorting.
  // Deprecated, check if arrival_port_arrival_date is set
  google.protobuf.BoolValue arrival_port_arrival_date_exists = 23 [deprecated = true];
  // If the shipment is completed. Shipment completed doesn't guarantee the shipment is at final_destination.
  google.protobuf.BoolValue is_completed = 24;
  // flex_id of a Client Freight Data Shipment.
  // Initially this was planned to be used for federation from the Client Freight Data service but we
  // federate on shipment_fid instead now.
  string flex_id = 25 [deprecated = true];
  //
  // The port of loading country code.
  string port_of_loading_country_code = 26;
  //
  // The port of unloading country code.
  string port_of_unloading_country_code = 27;
  //
  // An array containing all country code strings used to support the ANY filter option on locationFilters.
  repeated string all_country_codes = 28;
  //
  // The client facing transportation mode of the shipment.
  flexport.dumboindexing.derivedshipment.v1beta1.ClientFacingTransportationMode client_facing_transportation_mode = 29;
  //
  // 4pl Carrier Name.
  string carrier_name = 30;
  //
  // Exceptions associated with the shipment
  flexport.dumboindexing.clientshipmentexceptions.v1beta1.ClientShipmentExceptions shipment_exceptions = 31;
  //
  // The SCAC code of the main freight carrier of the shipement.
  string main_freight_carrier_scac_code = 32;

  // The time the shipment was archived
  google.protobuf.Timestamp archived_time = 33;
}

// ClientFreightShipment copy of SIS Date object.
// [DEPRECATED] Use flexport.dumboindexing.derivedshipment.v1beta1.ShipmentIndexDate instead.
message ShipmentIndexDate {
  // Start of the day (in UTC) for the date.
  string start_of_day_date_in_utc = 1;
  // Original IANA timezone for the location of the date (e.g. America/Los_Angeles)
  string zone = 2;
}
