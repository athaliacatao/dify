// TEAM: data_platform

syntax = "proto3";

package flexport.dataeng.envelope.v1beta1;

option java_multiple_files = true;
option java_outer_classname = "EntityEnvelopeProto";
option java_package = "com.flexport.dataeng.envelope.v1beta1";
option ruby_package = "Flexport::DataEng::Envelope::V1Beta1";

import "google/protobuf/any.proto";
import "google/protobuf/timestamp.proto";

// An envelope wraps around data ingestion EntityEvents to carry additional information about the event.
message EntityEnvelope {
  // UUID identifying the entity
  string entity_id = 1;
  // The entity payload
  google.protobuf.Any entity_payload = 2;
  // Type of entity operation
  Operation operation = 3;
  // Epoch time when the operation occurred
  google.protobuf.Timestamp operation_time = 4;
  // Total ordering over Entities with the same entity_uuid monotonically increasing where larger indicates later revisions.
  // There may be gaps in revision numbers.
  uint64 revision = 5;
}

// Entity operations.
enum Operation {
  OPERATION_INVALID = 0;
  OPERATION_CREATE = 1;
  OPERATION_UPDATE = 2;
  OPERATION_DELETE = 3;
}
