// TEAM: customs_platform

syntax = "proto3";

package flexport.customsisfservice.inboundisf.v1beta1;

import "flexport/customsisfservice/inboundisf/v1beta1/constants.proto";
import "google/protobuf/timestamp.proto";
import "google/protobuf/wrappers.proto";

option java_multiple_files = true;
option java_outer_classname = "InboundIsfProto";
option java_package = "com.flexport.customsisfservice.inboundisf.v1beta1";
option ruby_package = "Flexport::CustomsIsfService::InboundIsf::V1Beta1";

// This is our internal representation of an Inbound Importer Security Filing (ISF).
message InboundIsf {
  string fid = 1;
  IsfSourceType source = 2;
  string client_fid = 3;
  InboundIsfPayload data = 4;
  string shipment_fid = 5;
  string execution_order_fid = 6;
}

message InboundIsfPayload {
  Header header = 1;
  repeated ReferenceIdentifier reference_identifiers = 2;
  BillNumbers bill_numbers = 3;
  ShipmentInformation shipment_information = 4;
  repeated Entity entities = 5;
}

message Header {
  reserved 4, 5, 7;
  reserved "action_code", "action_reason_code";
  SubmissionType submission_type = 1;
  ShipmentType shipment_type = 2;
  ModeOfTransport mode_of_transport = 3;
  string bond_holder = 6;
  BondType bond_type = 8;
  BondActivity bond_activity_code = 9;
}

message ReferenceIdentifier {
  oneof identifier {
    string us_cbp_entry_number = 1;
    string carnet_issuing_country_code_and_carnet_number = 2;
    string bond_reference_number = 3;
    string surety_code = 4;
    string user_defined_reference_number = 5;
    string full_name_of_isf_filer = 6;
  }
}

message BillNumbers {
  string master_bill_of_lading_number = 1;
  repeated string house_bill_of_lading_numbers = 2;
  repeated string regular_bill_of_lading_numbers = 3;
}

message ShipmentInformation {
  ShipmentSubType shipment_sub_type = 1;
  CargoDetails cargo_details = 2;
  OceanFreightDetails ocean_freight_details = 3;
  repeated string purchase_order_numbers = 4;
  repeated string skus = 5;
}

message CargoDetails {
  google.protobuf.Int32Value estimated_value = 1;
  Quantity estimated_quantity = 2;
  Weight estimated_weight = 3;
}

message Quantity {
  UnitOfMeasure unit = 1;
  google.protobuf.Int32Value value = 2;
}

message Weight {
  WeightUnit unit = 1;
  google.protobuf.Int32Value value = 2;
}

message OceanFreightDetails {
  // Vessel ETD and ETA in UTC epoch time
  google.protobuf.Timestamp estimated_time_of_departure = 1;
  google.protobuf.Timestamp estimated_time_of_arrival = 2;
  PortDetails origin_port_details = 3;
  PortDetails destination_port_details = 4;
  repeated ContainerDetails container_details = 5;
}

message PortDetails {
  string name = 1;
  string schedule_d_code = 2;
  string schedule_k_code = 3;
  string unloccode = 4;
}

message ContainerDetails {
  string container_number = 1;
}

message Entity {
  string name = 1;
  EntityType entity_type = 2;
  oneof entity_identifier {
    string employer_identification_number = 3;
    string cbp_assigned_number = 4;
    string cbp_encrypted_consignee_id = 5;
    SocialSecurityCard social_security_card = 6;
    string standard_carrier_alpha_code_scac = 7;
    Passport passport = 8;
    string uncategorized_tax_id = 9;
    string duns_number = 10;
    string duns_plus_4_number = 11;
    string firms_code = 12;
  }
  AddressDetails address_details = 13;
  repeated HarmonizedTariffSchedule harmonized_tariff_schedule = 14;
  string entity_fid = 15;
}

message SocialSecurityCard {
  string date_of_birth = 1;
  string social_security_number = 2;
}

message Passport {
  string passport_number = 1;
  string country_of_issuance = 2;
  string date_of_birth = 3;
}

message AddressDetails {
  string address_line_1 = 1;
  string address_line_2 = 2;
  string city = 3;
  string state_province = 4;
  string postal_code = 5;
  string country_code = 6;
  string address_fid = 7;
}

message HarmonizedTariffSchedule {
  string harmonized_number = 1;
  string country_of_origin = 2;
}
