// TEAM: forwarding_platform

syntax = "proto3";

package flexport.executioncoordinator.executionoffering.v1;

option java_multiple_files = true;
option java_outer_classname = "NraConstraintsProto";
option java_package = "com.flexport.executioncoordinator.executionoffering.v1";
option ruby_package = "Flexport::ExecutionCoordinator::ExecutionOffering::V1";

// The Negotiated Rate Agreement (NRA) is a compliance document that describes Flexport NVOCC's
// ocean rate and terms to the client. When Flexport acts as an NVOCC by issuing a House
// Bill of Lading, we must issue an NRA document outlining the rate and terms. The NRA describes
// the details on the HBL about Flexport-acting-as-NVOCC's contract with the client, _not_ the
// details on the Master Bill of Lading about the external carrier. Both ocean LCL and FCL
// require NRAs for shipments to/from the USA where Flexport is acting as NVOCC.
message NraConstraints {
  //
  // The date the NRA rate expires, in the timezone of the place of receipt (if specified) or
  // port of loading (if place of receipt is not specified).
  NraRateExpirationDate nra_rate_expiration_date = 1;
  //
  // The place of receipt is where Flexport-acting-as-NVOCC takes possession of cargo.
  oneof place_of_receipt_constraint {
    //
    // Could be a port fid or an address fid.
    string place_of_receipt_fid = 4;
    string place_of_receipt_port_group_fid = 5;
  }
  //
  // The port of loading is where cargo is physically loaded onto the primary ocean vessel.
  oneof port_of_loading_constraint {
    string port_of_loading_fid = 6;
    string port_of_loading_port_group_fid = 7;
  }
  //
  // The port of unloading is where cargo are physically unloaded from the primary ocean vessel.
  oneof port_of_unloading_constraint {
    string port_of_unloading_fid = 8;
    string port_of_unloading_port_group_fid = 9;
  }
  //
  // The place of delivery is where Flexport-acting-as-NVOCC releases possession of cargo.
  oneof place_of_delivery_constraint {
    //
    // Could be a port fid or an address fid.
    string place_of_delivery_fid = 10;
    string place_of_delivery_port_group_fid = 11;
    NraLocationNames place_of_delivery_location_names = 12;
  }
}

// Names of metro areas or cities.
// Needed for backwards compatibility with legacy NRA generation logic:
// https://github.flexport.io/flexport/flexport/blob/f8ea61fc831d46abaf91dfd029d5246f13d40a5e/engines/ocean_manage/app/models/ocean_manage/nra_location_constraint.rb#L86
message NraLocationNames {
  repeated string names = 1;
}

// The NRA rate expiration date.
message NraRateExpirationDate {
  int32 year = 1;
  int32 month = 2;
  int32 day = 3;
}
