// TEAM: ds_planners

syntax = "proto3";

package flexport.tmsplanning.fae.v1beta1;

import "google/protobuf/timestamp.proto";

option java_multiple_files = true;
option java_outer_classname = "FAEProto";
option java_package = "com.flexport.tmsplanning.fae.v1beta1";
option ruby_package = "Flexport::TMSPlanning::FAE::V1Beta1";

message ShipmentInfo {
  string shipment_fid = 1;
  // The volume of the shipment (cbm) as used in planning
  float volume = 2;
  // The weight of the shipment (GW in kg) as used in planning
  float weight = 3;
}

message AssignedShipment {
  ShipmentInfo shipment_info = 1;
}

message UnassignedShipment {
  ShipmentInfo shipment_info = 1;
}

message AllotmentAssignment {
  string schedule_instance_fid = 1;
  // The loadable volume (cbm) in the allotment: sum of loadable volume of all ULDs
  float loadable_volume = 2;
  // The total volume (cbm) of the reserved ULDs
  float reserved_volume = 3;
  // The total volume (cbm) of the shipments assigned this allotment
  float assigned_volume = 4;
  // The total weight (GW in kg) of the shipments assigned this allotment
  float assigned_weight = 5;
  // The CBR of the shipment assignment, accounting for reservations (assuming reservations are fully utilized)
  float cbr = 6;
  // The list of shipments assigned to this allotment
  repeated AssignedShipment shipments = 7;
}

message FAEOnDemandInfo {
  // If on-demand run, email of requesting user
  string requested_by = 1;
  // If on-demand, the origins requested for the run
  repeated string requested_origins = 2;
  // If on-demand, the reason entered for the run
  string requested_reason = 3;
}

message FAESolutionInfo {
  // GUID identifier of the FAE solution. Corresponds to the `solution_id`` on the FAE side
  string solution_id = 1;
  // (FAE internal use) The solution_type parameter of FAE
  string solution_type = 2;
  // (FAE internal use) The internal version of the FAE solver
  string version = 3;
  // (FAE internal use) The deployment that generated this solution (e.g. `prod`, `staging`, etc...)
  string deployment = 4;
  // The time the run started. Identical to the `iso_datetime` parameter on FAE side.
  google.protobuf.Timestamp start_time = 5;
  // If this was an on-demand run, this will be populated with the detail
  FAEOnDemandInfo on_demand_info = 7;
}

message Assignments {
  FAESolutionInfo fae_solution_info = 1;
  // The list of allotments included in the run, containing the shipments assigned to each allotment.
  repeated AllotmentAssignment assignments = 2;
  // The list of shipments that were not assigned to any existing allotment
  repeated UnassignedShipment unassigned_shipments = 3;
}
