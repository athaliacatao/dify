// TEAM: unified_shipment_schedules

syntax = "proto3";

package flexport.executionperformance.v1beta1;

import "flexport/otp/v1beta1/milestone.proto";
import "flexport/otp/v1beta1/span.proto";
import "flexport/otp/v1beta1/time.proto";
import "flexport/otp/v1beta1/timeline.proto";

option java_multiple_files = true;
option java_outer_classname = "ExecutionPerformanceApiProto";
option java_package = "com.flexport.executionperformance.v1beta1";
option ruby_package = "Flexport::ExecutionPerformance::V1Beta1";

service ExecutionPerformanceAPI {
  rpc GetTimeline(GetTimelineRequest) returns (GetTimelineResponse);
  rpc ListTimelines(ListTimelinesRequest) returns (ListTimelinesResponse);
  rpc GetMilestone(GetMilestoneRequest) returns (GetMilestoneResponse);
  rpc ListMilestones(ListMilestonesRequest) returns (ListMilestonesResponse);
  rpc GetTime(GetTimeRequest) returns (GetTimeResponse);
  rpc ListTimes(ListTimesRequest) returns (ListTimesResponse);
  rpc CalculateIntervals(CalculateIntervalsRequest) returns (CalculateIntervalsResponse);
  rpc CalculateViolations(CalculateViolationsRequest) returns (CalculateViolationsResponse);
}

message GetTimelineRequest {
  oneof identifier {
    string fid = 1;
    string execution_order_fid = 2;
    string shipment_fid = 3;
  }
}

message GetTimelineResponse {
  flexport.otp.v1beta1.Timeline timeline = 1;
}

message ListTimelinesRequest {
  // The maximum number of entries to return. If a value of zero (the default) is provided, then 100 will be used.
  // If the value provided exceeds 10,000, then 10,000 will be used.
  uint32 limit = 1;
}

message ListTimelinesResponse {
  repeated flexport.otp.v1beta1.Timeline timelines = 1;
}

message GetMilestoneRequest {
  string fid = 1;
}

message GetMilestoneResponse {
  flexport.otp.v1beta1.Milestone milestone = 1;
}

message ListMilestonesRequest {
  // The maximum number of entries to return. If a value of zero (the default) is provided, then 100 will be used.
  // If the value provided exceeds 10,000, then 10,000 will be used.
  uint32 limit = 1;

  oneof criteria {
    string timeline_fid = 2;
    string execution_order_fid = 3;
    string shipment_fid = 4;
    string execution_task_fid = 5;
    string execution_cargo_fid = 6;
  }
}

message ListMilestonesResponse {
  repeated flexport.otp.v1beta1.Milestone milestones = 1;
}

message GetTimeRequest {
  string fid = 1;
}

message GetTimeResponse {
  flexport.otp.v1beta1.Time time = 1;
}

message ListTimesRequest {
  // The maximum number of entries to return. If a value of zero (the default) is provided, then 100 will be used.
  // If the value provided exceeds 10,000, then 10,000 will be used.
  uint32 limit = 1;

  string milestone_fid = 2;
}

message ListTimesResponse {
  repeated flexport.otp.v1beta1.Time times = 1;
}

message CalculateIntervalsRequest {
  oneof criteria {
    string timeline_fid = 1;
    string execution_order_fid = 2;
    string shipment_fid = 3;
  }
}

message CalculateIntervalsResponse {
  repeated flexport.otp.v1beta1.Interval intervals = 1;
}

message CalculateViolationsRequest {
  oneof criteria {
    string timeline_fid = 1;
    string execution_order_fid = 2;
    string shipment_fid = 3;
  }
}

message CalculateViolationsResponse {
  repeated flexport.otp.v1beta1.Violation violations = 1;
}
