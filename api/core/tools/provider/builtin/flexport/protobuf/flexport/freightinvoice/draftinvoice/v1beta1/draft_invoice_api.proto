// TEAM: finance

syntax = "proto3";

package flexport.freightinvoice.draftinvoice.v1beta1;

import "flexport/freightinvoice/date/v1/date.proto";
import "flexport/freightinvoice/draftinvoice/v1beta1/draft_invoice.proto";
import "flexport/freightinvoice/draftinvoice/v1beta1/draft_invoice_api_filters.proto";
import "flexport/freightinvoice/draftinvoice/v1beta1/draft_invoice_item.proto";
import "google/protobuf/struct.proto";
import "google/protobuf/wrappers.proto";

option java_multiple_files = true;
option java_outer_classname = "DraftInvoiceApiProto";
option java_package = "com.flexport.freightinvoice.draftinvoice.v1beta1";
option ruby_package = "Flexport::FreightInvoice::DraftInvoice::V1Beta1";

// API for the draft invoice product.
service DraftInvoiceAPI {
  // Fetch a draft invoice.
  rpc GetDraftInvoice(GetDraftInvoiceRequest) returns (GetDraftInvoiceResponse);
  // Fetch draft invoices.
  rpc GetDraftInvoices(GetDraftInvoicesRequest) returns (GetDraftInvoicesResponse);
  // Count draft invoices.
  rpc CountDraftInvoices(CountDraftInvoicesRequest) returns (CountDraftInvoicesResponse);
  // Create a draft invoice.
  rpc CreateDraftInvoice(CreateDraftInvoiceRequest) returns (CreateDraftInvoiceResponse);
  // Update draft invoice.
  rpc UpdateDraftInvoice(UpdateDraftInvoiceRequest) returns (UpdateDraftInvoiceResponse);
  // Share a draft invoice.
  rpc ShareDraftInvoice(ShareDraftInvoiceRequest) returns (ShareDraftInvoiceResponse);
  // Create a draft invoice item.
  rpc CreateDraftItem(CreateDraftItemRequest) returns (CreateDraftItemResponse);
  // Delete a draft invoice item.
  rpc DeleteDraftItem(DeleteDraftItemRequest) returns (DeleteDraftItemResponse);
}

message GetDraftInvoiceRequest {
  string draft_invoice_fid = 1;
}

message GetDraftInvoiceResponse {
  DraftInvoice draft_invoice = 1;
}

message GetDraftInvoicesRequest {
  DraftInvoiceApiFilters filters = 1;
}

message GetDraftInvoicesResponse {
  repeated DraftInvoice draft_invoices = 1;
}

message CountDraftInvoicesRequest {
  DraftInvoiceApiFilters filters = 1;
}

message CountDraftInvoicesResponse {
  int32 count = 1;
}

message CreateDraftInvoiceRequest {
  google.protobuf.StringValue invoiceable_fid = 1;
  InvoiceableType invoiceable_type = 2;
  google.protobuf.StringValue receiving_entity_fid = 4;
  google.protobuf.StringValue invoicing_entity_fid = 5;
  google.protobuf.StringValue currency_code = 6;
  google.protobuf.StringValue created_by_fid = 7;
  InvoiceType invoice_type = 8;
  google.protobuf.StringValue notes = 9;
  google.protobuf.StringValue source_key = 10;
  google.protobuf.Struct metadata = 11;
  google.protobuf.StringValue creation_source = 12;
}

message CreateDraftInvoiceResponse {
  DraftInvoice draft_invoice = 1;
}

message UpdateDraftInvoiceRequest {
  google.protobuf.StringValue draft_invoice_fid = 1;
  google.protobuf.StringValue invoicing_entity_fid = 2;
  google.protobuf.StringValue currency_code = 3;
}

message UpdateDraftInvoiceResponse {
  DraftInvoice draft_invoice = 1;
  bool success = 2;
  repeated google.protobuf.StringValue errors = 3;
}

message ShareDraftInvoiceRequest {
  google.protobuf.StringValue draft_invoice_fid = 1;
  google.protobuf.StringValue shared_by_user_fid = 2;
  flexport.freightinvoice.date.v1.Date due_date = 3;

  // Optional params. Leaving them nil will use the defaults
  google.protobuf.BoolValue skip_validation = 4;
  google.protobuf.BoolValue should_share_via_email = 5;
  google.protobuf.StringValue email_subject = 6;
  google.protobuf.StringValue email_body = 7;
}

message ShareDraftInvoiceResponse {
  bool success = 1;
  repeated google.protobuf.StringValue errors = 2;
}

message CreateDraftItemRequest {
  google.protobuf.StringValue draft_invoice_fid = 1;
  google.protobuf.StringValue template_fid = 2;
  google.protobuf.StringValue rate_type = 4;
  google.protobuf.StringValue currency_code = 7;
  google.protobuf.StringValue created_by_fid = 8;
  google.protobuf.StringValue per_unit = 5;
  google.protobuf.StringValue percent_base_slug = 6;
  ItemCreationSource item_creation_source = 9;
  google.protobuf.Int64Value buy_rate_micros = 10;
  google.protobuf.Int64Value sell_rate_micros = 11;
  google.protobuf.Int32Value quantity = 12;
  google.protobuf.Int32Value secondary_quantity = 13;
  google.protobuf.StringValue source_key = 14;
}

message CreateDraftItemResponse {
  DraftInvoiceItem draft_invoice_item = 1;
}

message DeleteDraftItemRequest {
  string draft_invoice_fid = 1;
  string draft_invoice_item_fid = 2;
  DeleteDraftInvoiceItemReason reason = 3;
  string deleted_by_fid = 4;
}

message DeleteDraftItemResponse {
  bool success = 1;
}
