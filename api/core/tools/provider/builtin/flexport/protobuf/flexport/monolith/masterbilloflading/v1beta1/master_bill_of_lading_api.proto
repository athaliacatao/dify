// TEAM: kingsroad

syntax = "proto3";

package flexport.monolith.masterbilloflading.v1beta1;

import "google/protobuf/timestamp.proto";

option java_multiple_files = true;
option java_outer_classname = "MasterBillOfLadingApiProto";
option java_package = "com.flexport.monolith.masterbilloflading.v1beta1";
option ruby_package = "Flexport::Monolith::MasterBillOfLading::V1Beta1";

service MasterBillOfLadingAPI {
  rpc GetMasterBillOfLadingList(GetMasterBillOfLadingListRequest) returns (GetMasterBillOfLadingListResponse);
  // GenerateMasterBillOfLading is designed only for automation in carrier-shipping-doc, do not use this api to create mbl.
  rpc GenerateMasterBillOfLading(GenerateMasterBillOfLadingRequest) returns (GenerateMasterBillOfLadingResponse);
}

message GetMasterBillOfLadingListRequest {
  message StringList {
    repeated string values = 1;
  }
  message Int32List {
    repeated int32 values = 1;
  }
  oneof identifier {
    StringList execution_plan_fid = 1;
    StringList shipment_fid = 2;
    StringList master_bill_of_lading_number = 3;
    Int32List master_bill_of_lading_id = 4;
  }
}

message GetMasterBillOfLadingListResponse {
  repeated MasterBillOfLading master_bill_of_ladings = 1;
}

message GenerateMasterBillOfLadingRequest {
  string shipment_fid = 1;
  string bill_number = 2;
  TransmissionMode transmission_mode = 3;
  ReleaseMethod release_method = 4;
  string bill_number_source = 5;
}

message GenerateMasterBillOfLadingResponse {
  repeated string errors = 1;
}

message MasterBillOfLading {
  int32 id = 1;
  string master_bill_of_lading_number = 2;
  string execution_task_fid = 3;
  TransmissionMode transmission_mode = 4;
  ReleaseMethod release_method = 5;

  string carrier_fid = 6;
  string shipment_fid = 7;
  string place_of_delivery_fid = 8;
  string place_of_receipt_fid = 9;
  string port_of_loading_fid = 10;
  string port_of_unloading_fid = 11;

  // User Refs
  string draft_approved_by_fid = 12;
  string created_by_fid = 13;
  string updated_by_fid = 14;

  // Document Refs
  int32 document_id = 15;
  int32 release_document_id = 16;

  // DateTime
  google.protobuf.Timestamp archived_at = 17;
  google.protobuf.Timestamp draft_approved_at = 18;
  google.protobuf.Timestamp released_at = 19;
  google.protobuf.Timestamp created_at = 20;
  google.protobuf.Timestamp updated_at = 21;
}

enum TransmissionMode {
  TRANSMISSION_MODE_INVALID = 0;
  TRANSMISSION_MODE_UNKNOWN = 1;
  TRANSMISSION_MODE_ORIGINAL = 2;
  TRANSMISSION_MODE_EXPRESS = 3;
}

enum ReleaseMethod {
  RELEASE_METHOD_INVALID = 0;
  RELEASE_METHOD_UNSPECIFIED = 1;
  RELEASE_METHOD_MAIL_COPY = 2;
  RELEASE_METHOD_HOLD_FOR_TELEX = 3;
}
