// TEAM: iam_platform

syntax = "proto3";

package flexport.authorization.apicredentials.v1beta1;

import "google/protobuf/wrappers.proto";

option java_multiple_files = true;
option java_outer_classname = "ApiCredentialsApiProto";
option java_package = "com.flexport.authorization.apicredentials.v1beta1";
option ruby_package = "Flexport::Authorization::ApiCredentials::V1Beta1";

// Concerns client credentials used for (public or internal) API access control
service ApiCredentialsAPI {
  // Returns client credentials used for (public or internal) API access control
  rpc CreateClient(CreateClientRequest) returns (CreateClientResponse);

  // Returns the client credentials associated with the given api_entity_fid (if exists).
  rpc GetClientCredentials(GetClientCredentialsRequest) returns (GetClientCredentialsResponse);

  // Given api_entity_fid, delete the client associated with it
  rpc DeleteClient(DeleteClientRequest) returns (DeleteClientResponse);

  // Returns a new Auth0ClientCredentials, rotate client secret with api_entity_fid
  rpc RotateClientSecret(RotateClientSecretRequest) returns (RotateClientSecretResponse);
}

message CreateClientRequest {
  string api_entity_fid = 1;
  google.protobuf.StringValue company_fid = 2;
  google.protobuf.StringValue client_fid = 3;
  string entity_name = 4;
}

message CreateClientResponse {
  string client_id = 1;
}

message GetClientCredentialsRequest {
  string api_entity_fid = 1;
}

message GetClientCredentialsResponse {
  string client_id = 1;
  string client_secret = 2;
}

message DeleteClientRequest {
  string api_entity_fid = 1;
}

message DeleteClientResponse {
  google.protobuf.BoolValue is_deleted = 1;
}

message RotateClientSecretRequest {
  string api_entity_fid = 1;
}

message RotateClientSecretResponse {
  string client_id = 1;
  string client_secret = 2;
}
