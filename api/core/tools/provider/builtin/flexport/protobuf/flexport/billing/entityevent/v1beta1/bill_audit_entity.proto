// TEAM: billing

syntax = "proto3";

package flexport.billing.entityevent.v1beta1;

import "google/protobuf/timestamp.proto";
import "google/protobuf/wrappers.proto";

option java_multiple_files = true;
option java_outer_classname = "BillAuditEntityProto";
option java_package = "com.flexport.billing.entityevent.v1beta1";
option ruby_package = "Flexport::Billing::EntityEvent::V1Beta1";

// The BillAudit entity object.
message BillAuditEntity {
  google.protobuf.StringValue fid = 1;
  google.protobuf.StringValue bill_fid = 2;
  google.protobuf.DoubleValue risk_rating = 3;
  BillAuditStatus status = 4;
  google.protobuf.StringValue assigned_to_fid = 5;
  google.protobuf.Timestamp due_at_time = 6;
  google.protobuf.Timestamp created_at_time = 7;
  google.protobuf.Timestamp updated_at_time = 8;
  BillAuditContextValue context = 9;
  repeated BillAuditIssueValue issue = 10;
}

// The BillAuditContext value object.
message BillAuditContextValue {
  google.protobuf.Int64Value revision = 1;
  google.protobuf.Timestamp created_at_time = 2;
  google.protobuf.Timestamp updated_at_time = 3;
  repeated BillAuditSectionValue section = 4;
}

// The BillAuditSection value object.
message BillAuditSectionValue {
  google.protobuf.StringValue key = 1;
  BillAuditSectionType type = 2;
  google.protobuf.Timestamp created_at_time = 3;
  google.protobuf.Timestamp updated_at_time = 4;
  oneof metadata {
    BillEpcDataAuditSectionMetadata bill_epc_data_audit_section_metadata = 5 [deprecated = true];
    ShipmentDetailsAuditSectionMetadata shipment_details_audit_section_metadata = 6;
    ShipmentEpcDataAuditSectionMetadata shipment_epc_data_audit_section_metadata = 7 [deprecated = true];
    VendorCurrencyDataAuditSectionMetadata vendor_currency_data_audit_section_metadata = 8 [deprecated = true];
    ShipmentFlagsAuditSectionMetadata shipment_flags_audit_section_metadata = 9 [deprecated = true];
    EpcDataAuditSectionMetadata epc_data_audit_section_metadata = 10;
    ShipmentMessagesAuditSectionMetadata shipment_messages_audit_section_metadata = 11;
  }
}

// [Deprecated] Use EpcDataAuditSectionMetadata instead.
message BillEpcDataAuditSectionMetadata {}

// The ShipmentDetailsAuditSectionMetadata value object (Details TBD).
message ShipmentDetailsAuditSectionMetadata {}

// [Deprecated] Use EpcDataAuditSectionMetadata instead.
message ShipmentEpcDataAuditSectionMetadata {}

// [Deprecated] Moved to upstream validation. No longer supported in bill audit flow.
message VendorCurrencyDataAuditSectionMetadata {}

// [Deprecated] Moved to upstream validation. No longer supported in bill audit flow.
message ShipmentFlagsAuditSectionMetadata {}

// The EpcDataAuditSectionMetadata value object (Details TBD).
message EpcDataAuditSectionMetadata {}

// The ShipmentMessageAuditSectionMetadata value object (Details TBD).
message ShipmentMessagesAuditSectionMetadata {}

// The BillAuditIssue value object.
message BillAuditIssueValue {
  BillAuditIssueType type = 1;
  google.protobuf.StringValue source_validator = 2;
  google.protobuf.StringValue affected_feature = 3;
  google.protobuf.DoubleValue risk_score = 4;
  google.protobuf.Timestamp created_at_time = 5;
  google.protobuf.Timestamp updated_at_time = 6;
  oneof metadata {
    BcoBillAuditIssueMetadata bco_bill_audit_issue_metadata = 7 [deprecated = true];
    MissingEpcAuditIssueMetadata missing_epc_audit_issue_metadata = 8;
    PossibleDuplicateAuditIssueMetadata possible_duplicate_audit_issue_metadata = 9;
    PotentialLateBillAuditIssueMetadata potential_late_bill_audit_issue_metadata = 10;
    ChargeEpcMismatchAuditIssueMetadata charge_epc_mismatch_audit_issue_metadata = 11;
    FlaggedDoNotPayAuditIssueMetadata flagged_do_not_pay_audit_issue_metadata = 12;
    BilledCostOutOfToleranceAuditIssueMetadata billed_cost_out_of_tolerance_audit_issue_metadata = 13;
    UnexpectedVendorCurrencyAuditIssueMetadata unexpected_vendor_currency_audit_issue_metadata = 14 [deprecated = true];
    MissingAuditSectionAuditIssueMetadata missing_audit_section_audit_issue_metadata = 15;
    MissingAuditSectionDataPointAuditIssueMetadata missing_audit_section_data_point_audit_issue_metadata = 16;
  }
}

// [Deprecated] Moved to upstream validation. No longer supported in bill audit flow.
message BcoBillAuditIssueMetadata {}

// The MissingEpcAuditIssueMetadata value object (Details TBD).
message MissingEpcAuditIssueMetadata {}

// The PossibleDuplicateAuditIssueMetadata value object (Details TBD).
message PossibleDuplicateAuditIssueMetadata {}

// The PotentialLateBillAuditIssueMetadata value object (Details TBD).
message PotentialLateBillAuditIssueMetadata {}

// The ChargeEpcMismatchAuditIssueMetadata value object (Details TBD).
message ChargeEpcMismatchAuditIssueMetadata {}

// The FlaggedDoNotPayAuditIssueMetadata value object (Details TBD).
message FlaggedDoNotPayAuditIssueMetadata {}

// The BilledCostOutOfToleranceAuditIssueMetadata value object (Details TBD).
message BilledCostOutOfToleranceAuditIssueMetadata {}

// [Deprecated] Moved to upstream validation. No longer supported in bill audit flow.
message UnexpectedVendorCurrencyAuditIssueMetadata {}

message MissingAuditSectionAuditIssueMetadata {}

message MissingAuditSectionDataPointAuditIssueMetadata {}

// The BillAuditStatus enum.
enum BillAuditStatus {
  BILL_AUDIT_STATUS_INVALID = 0;
  BILL_AUDIT_STATUS_INITIALIZING = 1;
  BILL_AUDIT_STATUS_PENDING = 2;
  BILL_AUDIT_STATUS_DISPUTED = 3;
  BILL_AUDIT_STATUS_ESCALATED = 4;
  BILL_AUDIT_STATUS_APPROVED = 5;
  BILL_AUDIT_STATUS_REOPENED = 6;
  BILL_AUDIT_STATUS_REJECTED = 7;
  BILL_AUDIT_STATUS_CANCELLED = 8;
}

// The BillAuditSectionType enum.
enum BillAuditSectionType {
  BILL_AUDIT_SECTION_TYPE_INVALID = 0;
  BILL_AUDIT_SECTION_TYPE_BILL_EPC_DATA = 1 [deprecated = true];
  BILL_AUDIT_SECTION_TYPE_SHIPMENT_DETAILS = 2;
  BILL_AUDIT_SECTION_TYPE_SHIPMENT_EPC_DATA = 3 [deprecated = true];
  BILL_AUDIT_SECTION_TYPE_VENDOR_CURRENCY_DATA = 4 [deprecated = true];
  BILL_AUDIT_SECTION_TYPE_SHIPMENT_FLAGS = 5 [deprecated = true];
  BILL_AUDIT_SECTION_TYPE_EPC_DATA = 6;
  BILL_AUDIT_SECTION_TYPE_SHIPMENT_MESSAGES = 7;
}

// The BillAuditIssueType enum
enum BillAuditIssueType {
  BILL_AUDIT_ISSUE_TYPE_INVALID = 0;
  BILL_AUDIT_ISSUE_TYPE_MISSING_EPC = 1;
  BILL_AUDIT_ISSUE_TYPE_POSSIBLE_DUPLICATE = 2;
  BILL_AUDIT_ISSUE_TYPE_POTENTIAL_LATE_BILL = 3;
  BILL_AUDIT_ISSUE_TYPE_CHARGE_EPC_MISMATCH = 4;
  BILL_AUDIT_ISSUE_TYPE_FLAGGED_DO_NOT_PAY = 5;
  BILL_AUDIT_ISSUE_TYPE_BILLED_COST_OUT_OF_TOLERANCE = 6;
  BILL_AUDIT_ISSUE_TYPE_BCO_BILL = 7 [deprecated = true];
  BILL_AUDIT_ISSUE_TYPE_UNEXPECTED_VENDOR_CURRENCY = 8 [deprecated = true];
  BILL_AUDIT_ISSUE_TYPE_MISSING_AUDIT_SECTION = 9;
  BILL_AUDIT_ISSUE_TYPE_MISSING_AUDIT_SECTION_DATA_POINT = 10;
}
