// TEAM: shipper_exp

syntax = "proto3";

package flexport.shipperexp.shippersisubmission.v1beta1;

option java_multiple_files = true;
option java_outer_classname = "ShipperSiSubmissionApiProto";
option java_package = "com.flexport.shipperexp.shippersisubmission.v1beta1";
option ruby_package = "Flexport::ShipperExp::ShipperSiSubmission::V1Beta1";

import "flexport/shipperexp/shippersisubmission/v1beta1/shipper_si_submission.proto";
import "google/protobuf/wrappers.proto";

// Shipper SI submission service.
service ShipperSiSubmissionAPI {
  // Get shipper SI submissions by shipment_fid.
  rpc GetShipperSiSubmissionsByShipmentFid(GetShipperSiSubmissionsByShipmentFidRequest) returns (GetShipperSiSubmissionsByShipmentFidResponse);
  // Get shipper SI submission by fid.
  rpc GetShipperSiSubmissionByFid(GetShipperSiSubmissionByFidRequest) returns (GetShipperSiSubmissionByFidResponse);
  // Get shipper SI submission by bill_of_lading fid.
  rpc GetShipperSiSubmissionByBillOfLadingFid(GetShipperSiSubmissionByBillOfLadingFidRequest) returns (GetShipperSiSubmissionByBillOfLadingFidResponse);
  // Get historical shipper SI submissions by shipper_fid and consignee_fid.
  rpc ListHistoricalShipperSiSubmissions(ListHistoricalShipperSiSubmissionsRequest) returns (ListHistoricalShipperSiSubmissionsResponse);
  // Update shipper SI document_fid.
  rpc UpdateShipperSiSubmissionDocumentFid(UpdateShipperSiSubmissionDocumentFidRequest) returns (UpdateShipperSiSubmissionDocumentFidResponse);
  // Update shipper SI bill_of_lading fid.
  rpc UpdateShipperSiSubmissionBillOfLadingFid(UpdateShipperSiSubmissionBillOfLadingFidRequest) returns (UpdateShipperSiSubmissionBillOfLadingFidResponse);
  // Delete shipper SI submission by fid.
  rpc DeleteShipperSiSubmission(DeleteShipperSiSubmissionRequest) returns (DeleteShipperSiSubmissionResponse);
  // Upsert shipper SI submission.
  rpc UpsertShipperSiSubmission(UpsertShipperSiSubmissionRequest) returns (UpsertShipperSiSubmissionResponse);
  // Revert shipper SI submission to previous version.
  rpc RevertShipperSiSubmission(RevertShipperSiSubmissionRequest) returns (RevertShipperSiSubmissionResponse) {
    option deprecated = true;
  }
}

message GetShipperSiSubmissionsByShipmentFidRequest {
  // shipment fid.
  string shipment_fid = 1;
}

message GetShipperSiSubmissionsByShipmentFidResponse {
  repeated flexport.shipperexp.shippersisubmission.v1beta1.ShipperSiSubmission shipper_si_submissions = 1;
}

message GetShipperSiSubmissionByFidRequest {
  // Shipper SI submission fid.
  string fid = 1;
}

message GetShipperSiSubmissionByFidResponse {
  flexport.shipperexp.shippersisubmission.v1beta1.ShipperSiSubmission shipper_si_submission = 1;
}

message GetShipperSiSubmissionByBillOfLadingFidRequest {
  // Bill of lading fid.
  string bill_of_lading_fid = 1;
}

message GetShipperSiSubmissionByBillOfLadingFidResponse {
  flexport.shipperexp.shippersisubmission.v1beta1.ShipperSiSubmission shipper_si_submission = 1;
}

message ListHistoricalShipperSiSubmissionsRequest {
  // shipper company entity fid.
  string shipper_fid = 1;
  // consignee company entity fid.
  string consignee_fid = 2;
  // Shipper SI submissions count.
  int32 limit = 3;
}

message ListHistoricalShipperSiSubmissionsResponse {
  repeated flexport.shipperexp.shippersisubmission.v1beta1.ShipperSiSubmission shipper_si_submissions = 1;
}

message UpdateShipperSiSubmissionDocumentFidRequest {
  // Shipper SI fid.
  string fid = 1;
  // Shipper SI pdf document fid.
  google.protobuf.StringValue document_fid = 2;
}

message UpdateShipperSiSubmissionDocumentFidResponse {}

message UpdateShipperSiSubmissionBillOfLadingFidRequest {
  // Shipper SI fid.
  string fid = 1;
  // Bill of lading fid.
  google.protobuf.StringValue bill_of_lading_fid = 2;
}

message UpdateShipperSiSubmissionBillOfLadingFidResponse {}

message DeleteShipperSiSubmissionRequest {
  // Shipper SI fid
  string fid = 1;
}

message DeleteShipperSiSubmissionResponse {}

message UpsertShipperSiSubmissionRequest {
  // Shipper SI submission data
  flexport.shipperexp.shippersisubmission.v1beta1.ShipperSiSubmission shipper_si_submission = 1;
  // This field is useless now, for we have done the data migration.
  bool includes_association_references = 2 [deprecated = true];
  // current draft / finalized
  bool is_draft = 3;
  // user fid.
  string submitted_by = 4;
  // uuid for async_job.
  string async_job_key = 5;
}

message UpsertShipperSiSubmissionResponse {
  // Shipper SI submission Fid
  string fid = 1;
  // This field is useless, for we are using async_job_id to do the compensating transaction.
  google.protobuf.Int64Value version_id = 2 [deprecated = true];
  // The async job id for this transaction, this field will be used notify shipper NIS the transaction status.
  google.protobuf.Int64Value async_job_id = 3;
}

message RevertShipperSiSubmissionRequest {
  // Shipper SI submission Fid
  string fid = 1;
  // Shipper SI version number
  google.protobuf.Int64Value version_id = 2;
}

message RevertShipperSiSubmissionResponse {}
