// TEAM: cost_capture

syntax = "proto3";

package flexport.financialledger.supplyservice.v1beta1;

import "flexport/financialvisibility/costitem/v1beta1/cost_item.proto";
import "flexport/financialvisibility/supplyservice/details/v1beta1/details.proto";
import "flexport/financialvisibility/supplyservice/rates/v1beta1/rates.proto";
import "google/protobuf/timestamp.proto";
import "google/protobuf/wrappers.proto";

option java_multiple_files = true;
option java_outer_classname = "SupplyServiceProto";
option java_package = "com.flexport.financialledger.supplyservice.v1beta1";
option ruby_package = "Flexport::FinancialLedger::SupplyService::V1Beta1";

// Historical support for external supply service.
message ExternalSupplyServiceDto {
  string supply_service_type = 1;
  string supply_service_identifier = 2;
}

// Historical support for external ProcurementContract.
message ExternalProcurementContractDto {
  string procurement_contract_type = 1;
  string procurement_contract_identifier = 2;
}

// The type of service provided by the supply service.
enum SupplyMode {
  SUPPLY_MODE_INVALID = 0;
  SUPPLY_MODE_AIR = 1;
  SUPPLY_MODE_OCEAN = 2;
  SUPPLY_MODE_TRUCKING = 3;
  SUPPLY_MODE_CUSTOMS = 4;
}

// Supply service record, consisting of a UUID, some identifiers to external
// supply service and contract records, and some additional metadata about
// the supply service.
message SupplyServiceDto {
  google.protobuf.StringValue id = 1;
  google.protobuf.StringValue fid = 2;
  SupplyMode supply_mode = 3;
  string name = 4;
  string supply_service_type = 5;
  string supply_service_identifier = 6;
  google.protobuf.StringValue contract_type = 7;
  google.protobuf.StringValue contract_identifier = 8;
  string vendor_company_fid = 9;
  google.protobuf.Timestamp created_at_time = 10;
  google.protobuf.Timestamp updated_at_time = 11;
  google.protobuf.Timestamp cancelled_at_time = 12;
  repeated details.v1beta1.DetailsDto details = 13;
  repeated rates.v1beta1.RatesDto rates = 14;
  ExternalIdentifier identifier = 15;
  google.protobuf.StringValue uuid = 16;
  google.protobuf.FloatValue consolidation_benefit_ratio = 17;
  google.protobuf.StringValue category = 18;
}

// SupplyService records collection message.
message SupplyServicesDto {
  repeated SupplyServiceDto supply_services = 1;
}

// Calculated SupplyService costs message.
message SupplyServiceCostsDto {
  string supply_service_id = 1;
  string details_fid = 2;
  string rates_id = 3;
  google.protobuf.Timestamp versioned_at_time = 4;
  repeated financialledger.costitem.v1beta1.CostItemDto cost_items = 5;
}

// SupplyService query filters message.
message SupplyServiceFiltersDto {
  repeated string fids = 1;
  repeated string ids = 2;
  repeated ExternalSupplyServiceDto external_supply_services = 3;
  repeated ExternalProcurementContractDto external_procurement_contracts = 4;
  repeated string vendor_company_fids = 5;
  repeated SupplyMode supply_modes = 6;
  ExternalIdentifier identifier = 7;
  repeated ExternalReferenceParametersDto external_reference_parameters = 8;
}

// Kinesis message emitted by the FinancialLedger RegisterSupplyService service
// when a supply service is registered.
message SupplyServiceRegistered {
  flexport.financialledger.supplyservice.v1beta1.SupplyServiceDto supply_service = 1;
  google.protobuf.Timestamp registered_at_time = 2;
}

// Kinesis message emitted by the FinancialLedger UpdateNonRateMetadata service
// when a supply service is re-registered.
message SupplyServiceReregistered {
  string previous_supply_service_type = 1;
  string previous_supply_service_identifier = 2;
  flexport.financialledger.supplyservice.v1beta1.SupplyServiceDto supply_service = 3;
  google.protobuf.Timestamp reregistered_at_time = 4;
}

// Kinesis message emitted by the FinancialLedger CancelSupplyService service
// when a supply service is cancelled.
message SupplyServiceCancelled {
  flexport.financialledger.supplyservice.v1beta1.SupplyServiceDto supply_service = 1;
  google.protobuf.Timestamp cancelled_at_time = 2;
}

// Mode agnostic Supply Service registration details.
message SupplyServiceRegistrationDetailsDto {
  google.protobuf.StringValue name = 1;
  google.protobuf.StringValue supply_service_type = 2;
  google.protobuf.StringValue supply_service_identifier = 3;
  google.protobuf.StringValue contract_type = 4;
  google.protobuf.StringValue contract_identifier = 5;
}

// The type of supply service reference.
enum ReferenceType {
  REFERENCE_TYPE_INVALID = 0;
  REFERENCE_TYPE_SHIPMENT_ID = 1;
  REFERENCE_TYPE_MBL = 2;
  REFERENCE_TYPE_MAWB = 3;
  REFERENCE_TYPE_DO = 4;
}

message ExternalReferenceParametersDto {
  ReferenceType reference_type = 1;
  string reference_value = 2;
}

message ExternalIdentifier {
  string fid = 1;
  google.protobuf.StringValue selector = 3;
}

// The OMDAC category of the Supply Service.
enum Category {
  CATEGORY_INVALID = 0;
  CATEGORY_ORIGIN = 1;
  CATEGORY_MAIN = 2;
  CATEGORY_DESTINATION = 3;
  CATEGORY_IMPORT_CUSTOMS = 4;
  CATEGORY_EXPORT_CUSTOMS = 5;
  CATEGORY_INSURANCE = 6;
  CATEGORY_CAPITAL = 7;
  CATEGORY_OTHER = 8;
  CATEGORY_CUSTOMS = 9;
}
